var PA=PA||{};PA.SoGe={init:function($wrapper){this.$wrapper=$wrapper;this.$wrapper.on("click",".js-calculate",this.calculate);this.$wrapper.on("change",".js-type",function(){PA.SoGe.syncInterest();PA.SoGe.syncPrice();PA.SoGe.syncSign();PA.SoGe.syncAmount()});this.$wrapper.on("change",".js-period",function(){PA.SoGe.syncInterest()});this.$wrapper.on("input",".js-price",PA.SoGe.syncAmount);this.$wrapper.on("keyup",".js-price",PA.SoGe.syncDeposit);this.$wrapper.on("input",".js-deposit",PA.SoGe.syncAmount);this.syncInterest();this.scrollToDetails()},syncSign:function(){var type=$(".js-type",PA.SoGe.$wrapper).val();var $soge_currency_sign=$(".soge-currency-sign");if(type=="with_interest_rsd"){$soge_currency_sign.text("RSD")}else{$soge_currency_sign.html("&euro;")}PA.SoGe.syncDeposit();$(".js-calculation",PA.SoGe.$wrapper).slideUp()},syncPrice:function(){var $type=$(".js-type",PA.SoGe.$wrapper);var $price=$(".js-price",PA.SoGe.$wrapper);var selected=$type.data()["selected"];$type.data("selected",$type.val());if($type.val()=="with_interest_rsd"){$price.val($price.val()*120)}else if(selected=="with_interest_rsd"){$price.val($price.val()/120)}},syncDeposit:function(){var price=$(".js-price",PA.SoGe.$wrapper).val();var $deposit=$(".js-deposit",PA.SoGe.$wrapper);var type=$(".js-type",PA.SoGe.$wrapper).val();if(type=="with_interest_rsd"){if(price>=18e5){$deposit.attr("min",10).val(10)}else{$deposit.attr("min",0).val(0)}}else{$deposit.attr("min",30).val(30)}},calculate:function(){var $calculation=$(".js-calculation",PA.SoGe.$wrapper),price=parseInt($(".js-price",PA.SoGe.$wrapper).val()),deposit=parseInt($(".js-deposit",PA.SoGe.$wrapper).val()),amount=parseInt($(".js-amount",PA.SoGe.$wrapper).val()),period=parseInt($(".js-period",PA.SoGe.$wrapper).val()),interest=parseInt($(".js-interest",PA.SoGe.$wrapper).val()),type=$(".js-type",PA.SoGe.$wrapper).val(),monthlyRate,depositAmount,loanAmount,interestAmount;if(deposit>0){if(deposit>80){$(".js-deposit",PA.SoGe.$wrapper).val(80);deposit=80}else if(type=="with_interest_eur"&&deposit<30){$(".js-deposit",PA.SoGe.$wrapper).val(30);deposit=30}else if(type=="with_interest_rsd"){if(price>=186e4&&deposit<10){$(".js-deposit",PA.SoGe.$wrapper).val(10);deposit=10}}}else if(deposit==0&&type=="with_interest_rsd"&&price>=186e4){$(".js-deposit",PA.SoGe.$wrapper).val(10);deposit=10}else{if(type!="with_interest_rsd"){$(".js-deposit",PA.SoGe.$wrapper).focus();return}}if($(".js-type",PA.SoGe.$wrapper).val()=="no_interest"){monthlyRate=amount/period}else{monthlyRate=amount*interest/(1200*(1-Math.pow(1+interest/1200,-period)))}depositAmount=deposit/100*price;loanAmount=monthlyRate*period;interestAmount=loanAmount-amount;var currency="&euro;";if(type=="with_interest_rsd"){currency="RSD"}$(".js-monthly-rate",PA.SoGe.$wrapper).html(monthlyRate.toFixed(2).replace(/[.,]00$/,"")+" "+currency);$(".js-deposit-amount",PA.SoGe.$wrapper).html(depositAmount.toFixed(2).replace(/[.,]00$/,"")+" "+currency);$(".js-loan-amount",PA.SoGe.$wrapper).html(loanAmount.toFixed(2).replace(/[.,]00$/,"")+" "+currency);$(".js-interest-amount",PA.SoGe.$wrapper).html(interestAmount.toFixed(2).replace(/[.,]00$/,"").replace(/[-]/,"")+" "+currency);if($calculation.is(":hidden")){$calculation.slideDown();$(".js-calculate",PA.SoGe.$wrapper).text("Raƒçunaj ponovo")}else{$calculation.effect("highlight",{color:"#ed1a3a"},300)}return false},syncInterest:function(){var type=$(".js-type",PA.SoGe.$wrapper).val();var interest=$(".js-interest",PA.SoGe.$wrapper);if(type=="no_interest"){interest.val(0)}else{if(type=="with_interest_rsd"){interest.val(7.95)}else{interest.val(5.88)}}},syncAmount:function(){var price=parseInt($(".js-price",PA.SoGe.$wrapper).val()),amount=price-parseInt($(".js-deposit",PA.SoGe.$wrapper).val())/100*price;$(".js-amount",PA.SoGe.$wrapper).val(amount)},scrollToDetails:function(){$("#viewDetailedAutoLoans").click(function(){$(".tabs a[rel=credits]").click();$("html, body").animate({scrollTop:$(".tab-holder-classified-desktop").offset().top-10},1e3)})},sendContactEmail:function(){$("form[name=contact_soge]").submit(function(e){PA.common.loaderStart();var form=$(this);var classifiedId=$("#contact_soge_classifiedId",form).val();$.ajax({type:"POST",url:"/Classified/SendSOGE/"+classifiedId,data:form.serialize()}).always(function(message){PA.common.loaderStop();UIkit.modal.alert(message)});return false})}};